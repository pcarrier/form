<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>formic.id</title>
    <style>
      @font-face {
        font-family: "PragmataPro";
        font-style: normal;
        font-weight: 400;
        src: url(fonts/PragmataProR_liga_0829.ttf) format("truetype");
      }

      @font-face {
        font-family: "PragmataPro";
        font-style: normal;
        font-weight: 700;
        src: url(fonts/PragmataProB_liga_0829.ttf) format("truetype");
      }

      @font-face {
        font-family: "PragmataPro";
        font-style: italic;
        font-weight: 400;
        src: url(fonts/PragmataProI_liga_0829.ttf) format("truetype");
      }

      @font-face {
        font-family: "PragmataPro";
        font-style: italic;
        font-weight: 700;
        src: url(fonts/PragmataProZ_liga_0829.tff) format("truetype");
      }

      * {
        font-family: PragmataPro, PragmataPro, monospace;
        text-align: center;
      }
      a {
        text-decoration: none;
      }

      html {
        color: #666;
        background-color: #fff;
      }

      h1,
      h2,
      tt,
      pre {
        color: #000;
      }
    </style>
  </head>

  <body>
    <div id="root">
      <h1>loading…</h1>
      <div id="target" style="display: none">
        <p>
          <tt>form</tt> is in its infancy. Intended to be a slow but expressive
          <a href="https://concatenative.org">concatenative</a>
          <a href="https://en.wikipedia.org/wiki/Homoiconicity">homoiconic</a>
          <a href="https://en.wikipedia.org/wiki/Interpreter_(computing)"
            >interpreted</a
          >
          language.<br />Acyclic data is congruent to
          <a href="https://cbor.io">CBOR</a> hence STOR (Simple Textual Object
          Representation,
          <a href="https://github.com/pcarrier/form/blob/main/notes.md#stor"
            >being drafted</a
          >).<br />Code runs on manipulable stacks &amp; dynamic scopes.
        </p>
        <form id="bootform">
          <p>
            <input
              type="text"
              id="boot"
              placeholder="Enter STOR, then press ⏎ or click eval"
              style="width: 80%; font-size: 100%"
            />
          </p>
          <p>
            <input type="submit" id="go" value="eval" style="font-size: 100%" />
          </p>
        </form>
        <h2>Starting points</h2>
        <pre><a class="evaluable" href="#">'/devenv fetch 'body get stor> eval</a>
<a class="evaluable" href="#">{ 'url 'https://pcarrier.com 'headers { 'accept 'application/cbor+form } } fetch 'body get cbor> eval</a></pre>
      </div>
      <p>
        <small>
          © 2023 <a href="https://pcarrier.com/">Pierre Carrier</a>.
          <a href="https://github.com/pcarrier/form">Code</a> licensed under
          <a
            href="https://raw.githubusercontent.com/pcarrier/form/main/LICENSE.md"
            >Zero-Clause BSD</a
          >.
          <a href="https://en.wikipedia.org/wiki/File:Ant_(Jacob_Eckert).svg"
            >Logo</a
          >
          by Jacob Eckert.
          <a href="https://fsd.it/shop/fonts/pragmatapro/">Font</a> by Fabrizio
          Schiavi Design.
        </small>
      </p>
    </div>
    <script>
      Array.from(document.querySelectorAll(".evaluable")).forEach((c) => {
        c.onclick = (e) => {
          e.preventDefault();
          document.getElementById("boot").value = c.textContent;
        };
      });
      const worker = new Worker("worker.js");
      window.$worker = worker;
      window.$target = document.getElementById("target");
      // First message indicates the worker has started.
      worker.onmessage = (evt) => {
        if (evt.data) {
          console.log(`Failed loading: ${evt.data}`);
        } else {
          worker.onmessage = (evt) => eval(evt.data);
          $target.style.display = "block";
          document.getElementsByTagName("h1")[0].innerHTML =
            '<span style="font-size: 400%"></span><br/>formic.id';
        }
      };

      document.getElementById("bootform").addEventListener("submit", (e) => {
        e.preventDefault();
        worker.postMessage([0, document.getElementById("boot").value]);
      });
    </script>
  </body>
</html>
